package cn.ctyun.bigdata.bdcsc.core.utility;

import org.apache.commons.codec.binary.Hex;
import org.apache.commons.codec.digest.DigestUtils;

import cn.ctyun.bigdata.bdcsc.core.model.wide.MdnIdcardStatus;
import cn.ctyun.bigdata.bdcsc.core.storage.kv.KvStore;
import cn.ctyun.bigdata.bdcsc.core.storage.kv.KvTable;
import cn.ctyun.bigdata.bdcsc.core.storage.kv.redis.RedisStoreFactory;
import junit.framework.TestCase;

public class ODSTest extends TestCase{

	protected void setUp() throws Exception {
		super.setUp();
	}
	
	public void testAll() throws Exception {
		final MdnIdcardStatus mis = new MdnIdcardStatus();
		RedisStoreFactory redisStorefactory = new RedisStoreFactory(poolConfig, host, port);
		KvStore store = redisStorefactory.getKvStore("admin", admin);
		
		try {
			mis.setMdn("");
			mis.setTranstype("1");
			
			KvTable table = store.getDataBase(MdnIdcardStatus.MAPPING.getDatabase()).getTable(MdnIdcardStatus.MAPPING.getTable());
			table.set("123456", DigestUtils.md5(mis.getMdn()), mis.toByteArray());
	}

}
